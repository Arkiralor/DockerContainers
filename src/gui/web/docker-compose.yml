## DEPRECATED: This file is no longer used. The project has been restructured to use separate Dockerfiles for the server and client, and the application is now run on bare metal instead of using Docker Compose. Please refer to the README.md for updated instructions on how to run the application.

services:
  docker-gui-server:
    build:
      context: .
      dockerfile: server/Dockerfile
    container_name: docker-gui-server
    ports:
      - "5001:5001"
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock:ro
      - /Users/arkiralor/Developer/DockerContainers:/repo:ro
    environment:
      - PORT=5001
      - CLIENT_URL=http://localhost:3000
      - LOG_LEVEL=info
      - NODE_ENV=production
      - REPO_ROOT=/repo
      - HOST_REPO_ROOT=/Users/arkiralor/Developer/DockerContainers
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "wget", "--quiet", "--tries=1", "--spider", "http://localhost:5001/api/health"]
      interval: 30s
      timeout: 10s
      retries: 3
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"
    deploy:
      resources:
        limits:
          memory: 512m
          cpus: '0.5'

  docker-gui-client:
    build:
      context: .
      dockerfile: client/Dockerfile
    container_name: docker-gui-client
    ports:
      - "3000:80"
    depends_on:
      docker-gui-server:
        condition: service_healthy
    restart: unless-stopped
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"
    deploy:
      resources:
        limits:
          memory: 256m
          cpus: '0.25'
